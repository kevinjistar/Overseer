
---
Document: Structure_Firestore
Version: 1.0.0
Date: 2025-12-09

PolicyVersions:
  ValidationPolicy_Global: 1.0.0
  WorkflowPolicy: 1.0.0
  CorrectionMode_Policy: 1.0.0
  System_Agent_Edit_Policy: 1.0.0
---

# Structure Firestore

## Objet du document

Ce document définit la structure officielle de stockage Firestore utilisée par le système Overseer.

## Rôle du document dans le système

Niveau: normatif et structurel.  
Ce document décrit l’arborescence de stockage, les collections, sous-collections et conventions associées servant de base de persistance pour les projets, documents, workflows, logs, snapshots et contextes utilisateurs.  
Il constitue une référence obligatoire pour l’orchestrateur et les processus système.  
Il ne décrit aucune logique métier, aucun processus opérationnel et aucune règle de validation sémantique.

---

# Structure Firestore

La structure Firestore définie ici constitue la base de stockage du système multi-projets Overseer.  
Elle doit être strictement respectée par l’orchestrateur, les agents et les processus internes.

---

# 1. Racines principales

Les collections racines du système sont:

- projects/  
- userContext/  
- systemLogs/  
- systemSettings/  

Aucune autre collection racine n’est autorisée.

---

# 2. Collection projects/{projectId}

Chaque projet possède sa propre arborescence interne isolée.

projects/{projectId}/
meta/
project.json
documents/
workflowEngine/
logs/
snapshots/
settings/

---

# 3. Détail des sous-structures

## 3.1 meta/

Contient les métadonnées générales du projet.

Chemin:
projects/{projectId}/meta/project.json

Champs typiques:
- projectId  
- name  
- createdAt  
- createdBy  
- status  
- description  

---

## 3.2 documents/

Contient les documents référents du projet.

projects/{projectId}/documents/
architecture.json
ux.json
strategy.json
workflowDocument.json
notes.json

Chaque document respecte:
- le Schéma universel du Document Référent,
- son module spécialisé associé.

---

## 3.3 workflowEngine/

Contient le Workflow Engine structurel du projet.

Chemin:
projects/{projectId}/workflowEngine/engine.json

Contient:
- états déclaratifs,
- transitions structurelles,
- actions structurelles,
- état initial.

Aucune logique métier n’y est stockée.

---

## 3.4 logs/

Contient l’historique des opérations projet.

projects/{projectId}/logs/
creation.json
updates/{logId}.json

Les logs assurent la traçabilité complète.

---

## 3.5 snapshots/

Contient les snapshots permettant le rollback.

projects/{projectId}/snapshots/
initial/
project.json
documents/
workflowEngine.json
versions/
{snapshotId}/
project.json
documents/
workflowEngine.json
timestamp
reason
agent

---

## 3.6 settings/

Contient les paramètres système propres au projet.

---

# 4. Collection userContext/

Stocke le contexte utilisateur, notamment le projet actif.

userContext/{userId}/
currentProject.json

Champs typiques:
- projectId  
- selectedAt  
- selectedBy  
- status  

---

# 5. Collection systemLogs/

Journalisation globale du système.

systemLogs/
currentProjectSwitch/{logId}.json
agentActivity/{logId}.json
errors/{logId}.json

---

# 6. Collection systemSettings/

Configuration interne globale.

systemSettings/
pipelines/
constraints/
versioning.json
agentRules.json
workflowRules.json

---

# 7. Règles structurelles invariantes

Toujours vraies:

- aucune écriture directe hors orchestrateur,
- aucune collection dynamique non déclarée,
- aucun document hors projet pour les documents référents,
- aucune logique métier persistée en base,
- toute écriture liée à un projectId valide,
- toute mutation journalisée.

---
Fin du document
---

Document Metadata & Changelog

Changelog:
  - 1.0.0 (2025-12-09): Création du document Structure Firestore, définition de l’arborescence de stockage du système Overseer.

Breaking Changes:
  - Aucun depuis 1.0.0
